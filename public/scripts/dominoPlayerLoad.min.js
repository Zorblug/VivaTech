"use strict";!function(){function t(){$(".partElement").remove(),o.getHand().hand.map(function(t,e){d3.select("#hand").append("div").attr("id","part_"+e).attr("class","partElement"),dominoPartGraphic.create("#part_"+e,t)})}function e(){if(o.isActivated()){var e=o.getHand();console.log(JSON.stringify(e)),e.canPlay?e.playablesDom.map(function(e,r){if(e[0]>=0){var a="#part_"+r;d3.select(a).select("#top").insert("rect",":first-child").attr("x",11).attr("y",11).attr("z","10000").attr("width",88).attr("height",88).attr("rx",5).attr("ry",5).attr("fill","#95f724").style("opacity",.4),d3.select(a).select("#top").on("click",function(){console.log(a+" top"+e[0]),o.play(r,e[0],function(e){console.log("JOUER :"+JSON.stringify(e)),t(),n()})})}if(e[1]>=0){var a="#part_"+r;d3.select(a).select("#bottom").insert("rect",":first-child").attr("x",111).attr("y",11).attr("z","10000").attr("rx",5).attr("ry",5).attr("width",88).attr("height",88).attr("fill","#95f724").style("opacity",.4);d3.select(a).select("#bottom").select("rect");d3.select(a).select("#bottom").on("click",function(){console.log(a+" bottom"+e[1]),o.play(r,e[1],function(e){console.log("JOUER :"+JSON.stringify(e)),t(),n()})})}}):($("#shaderPicker").show(),setTimeout(function(){o.pick(function(e){t(),n(),$("#shaderPicker").hide()})},5e3))}}function r(){n(),i=setInterval(function(){s[0]+=.03,d3.select("#progressBar").select("#reflection").transition().attr("width",200*s[0]-8),d3.select("#progressBar").select("#hash").transition().attr("width",200*s[0]),d3.select("#progressBar").select("#progress").transition().attr("width",200*s[0]),s[0]>=1&&n()},1e3)}function n(){i&&(clearInterval(i),i=void 0,s=[.1],d3.select("#progressBar").select("#reflection").transition().attr("width",200*s[0]-8),d3.select("#progressBar").select("#hash").transition().attr("width",200*s[0]),d3.select("#progressBar").select("#progress").transition().attr("width",200*s[0]))}function a(){progressBar.create("#divProgressBar",s),$("#shaderPicker").hide(),o.onStart(function(){console.log(JSON.stringify(o.getHand())),$("#startPage").hide(),$("#handPage").show(),$("#handPageTitle").html("Joueur : "+o._playerData.data.name),console.log(o.getHand().hand),t(),e(),r()}),o.onNewPlayer(function(t){$("#infobar").html(t.player.data.name+" a rejoint la partie"),t.count>1&&$("#start").attr("disabled",!1),console.log("NEW PLAYER :"+JSON.stringify(t))}),o.onTurnChange(function(t){console.log("TURN :"+JSON.stringify(t)),e(),o.isActivated()?r():n()}),o.onGameOver(function(t){$("#handPage").hide(),$("#gameOver").show(),console.log("GAME OVER :"+JSON.stringify(t)),t.iWin?$("#winner").html("Bravo! Vous avez gagné!"):($("#winner").html("Dommage... Vous avez perdu..."),$("#winnerName").html("Le gagnant est "+t.winner.data.name))}),o.onError(function(t){console.log("ERROR :"+JSON.stringify(t))}),o.onTimeout(function(e){console.log("TIMEOUT :"+JSON.stringify(e)),t(),n()}),o.onClose(function(t){console.log("CLOSE :"+JSON.stringify(t))});var a=document.getElementById("register"),i=document.getElementById("start");a.addEventListener("click",function(){var t=$("#playerName").val();t||(t="player"),console.log(t),o.init({name:t},function(e){console.log("INIT callback: "+JSON.stringify(e)),$("#registerPage").hide(),$("#startPage").show(),0===e.idx?($("#start").attr("disabled",!0),$("#start").show(),$("#accueil").html("Bienvenue "+t+"! La partie va bientôt débuter. Vous êtes le premier joueur, attendez au moins un autre participant et vous pourrez lancer la partie avec le bouton START.")):($("#start").hide(),$("#accueil").html("Bienvenue "+t+"! La partie va bientôt débuter. Patientez l'arrivée d'autres joueurs ou le lancement de la partie par le premier joueur inscrit."))})}),i.addEventListener("click",function(){o.start(),console.log("start")})}var o=new Domino.PlayerInterface("http://"+config.address+":"+config.port);document.addEventListener("DOMContentLoaded",a);var i=void 0,s=[.13]}();